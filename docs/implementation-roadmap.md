# êµ¬í˜„ ë¡œë“œë§µ

[â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°](../README.md)

-----

## ğŸ“‹ ëª©ì°¨

1. [ì „ì²´ ëª©í‘œ](#ì „ì²´-ëª©í‘œ)
1. [ë¡œë“œë§µ ê°œìš”](#ë¡œë“œë§µ-ê°œìš”)
1. [Phase 0: ì„¤ê³„ í™•ì •](#phase-0-ì„¤ê³„-í™•ì •)
1. [Phase 1: MVP êµ¬í˜„](#phase-1-mvp-êµ¬í˜„)
1. [Phase 2: ì´ë²¤íŠ¸ ì‹ ë¢°ì„±](#phase-2-ì´ë²¤íŠ¸-ì‹ ë¢°ì„±)
1. [Phase 3: Snapshot](#phase-3-snapshot)
1. [Phase 4: Admin Dashboard](#phase-4-admin-dashboard)

-----

## ì „ì²´ ëª©í‘œ

### í•µì‹¬ ëª©í‘œ

> **â€œì‹¤ì‹œê°„ íŒì •ì€ ë©”ëª¨ë¦¬ì—ì„œ ëë‚˜ê³ , ê¸°ë¡ê³¼ ë³µêµ¬ëŠ” ë¹„ë™ê¸°ë¡œ í¡ìˆ˜ë˜ëŠ” êµ¬ì¡°ë¥¼ ì‹¤ì œë¡œ ì¦ëª…í•œë‹¤.â€**

### ì´ í¬íŠ¸í´ë¦¬ì˜¤ëŠ”

```
âœ— ëŒ€ê·œëª¨ MMO ì™„ì„± êµ¬í˜„ì„ ëª©í‘œë¡œ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
âœ— í™”ë ¤í•œ í´ë¼ì´ì–¸íŠ¸ë‚˜ ì½˜í…ì¸  ë³¼ë¥¨ì„ ì¶”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
âœ— ëª¨ë“  ê¸°ëŠ¥ì„ ë‹¤ ë§Œë“œëŠ” ê²ƒì„ ì§€ì–‘í•©ë‹ˆë‹¤

âœ“ ìš´ì˜ ê°€ëŠ¥í•œ ì‹¤ì‹œê°„ ì‹œìŠ¤í…œì˜ í•µì‹¬ êµ¬ì¡°ë§Œì„
âœ“ ìµœì†Œ êµ¬í˜„ìœ¼ë¡œ ì¦ëª…í•˜ëŠ” ê²ƒì´ ëª©ì ì…ë‹ˆë‹¤
```

-----

## ë¡œë“œë§µ ê°œìš”

```
Phase 0. ì„¤ê³„ í™•ì • (ë¬¸ì„œ)              âœ… ì™„ë£Œ
Phase 1. MVP êµ¬í˜„ (í•µì‹¬ íë¦„)          ğŸ”„ ì§„í–‰ ì˜ˆì •
Phase 2. ì´ë²¤íŠ¸ ì‹ ë¢°ì„±                  ğŸ“‹ ê³„íš
Phase 3. Hot/Cold Snapshot             ğŸ“‹ ê³„íš
Phase 4. Admin Dashboard               ğŸ“‹ ê³„íš
```

### ì „ì²´ íƒ€ì„ë¼ì¸

|Phase  |ë‚´ìš©             |ì˜ˆìƒ ì†Œìš”|ìƒíƒœ     |
|-------|---------------|-----|-------|
|Phase 0|ì„¤ê³„ í™•ì •          |1~2ì¼ |âœ… ì™„ë£Œ   |
|Phase 1|MVP êµ¬í˜„         |1~2ì£¼ |ğŸ”„ ì§„í–‰ ì˜ˆì •|
|Phase 2|ì´ë²¤íŠ¸ ì‹ ë¢°ì„±        |3~5ì¼ |ğŸ“‹ ê³„íš   |
|Phase 3|Snapshot       |4~7ì¼ |ğŸ“‹ ê³„íš   |
|Phase 4|Admin Dashboard|3~5ì¼ |ğŸ“‹ ê³„íš   |

**ì´ ì˜ˆìƒ ê¸°ê°„**: ì•½ 3~4ì£¼

-----

## Phase 0: ì„¤ê³„ í™•ì •

### âœ… ì™„ë£Œ

**ëª©ì **: â€œì´ ì‹œìŠ¤í…œì€ ì´ë ‡ê²Œ ë§Œë“¤ê¸°ë¡œ ê²°ì •í–ˆë‹¤â€ëŠ” ê¸°ì¤€ì„ ê³ ì •

**ì‚°ì¶œë¬¼**:

- âœ… ìµœì¢… ì•„í‚¤í…ì²˜ ì„¤ê³„ ë¬¸ì„œ
- âœ… ì„¤ê³„ ì›ì¹™ ëª…ë¬¸í™”
- âœ… ëŒ€ì•ˆ ë¹„êµì™€ ì„ íƒ ì´ìœ 
- âœ… ìš´ì˜ ê´€ì  ì„¤ê³„

**í™•ì •ëœ ì„¤ê³„ ì›ì¹™**:

```
âœ“ Server-authoritative êµ¬ì¡°
âœ“ Packet â†’ Command â†’ Domain â†’ Event íë¦„
âœ“ ì‹¤ì‹œê°„ ì²˜ë¦¬ì™€ ë¹„ë™ê¸° ê¸°ë¡ì˜ ëª…í™•í•œ ë¶„ë¦¬
âœ“ ê²Œì„ ì„œë²„ëŠ” DB ì„±ê³µ/ì‹¤íŒ¨ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•ŠëŠ”ë‹¤
```

**ì´ ë‹¨ê³„ëŠ” ì´í›„ ëª¨ë“  êµ¬í˜„ íŒë‹¨ì˜ ê¸°ì¤€ì„ ì´ ë©ë‹ˆë‹¤.**

-----

## Phase 1: MVP êµ¬í˜„

### ğŸ”„ ì§„í–‰ ì˜ˆì •

**ëª©ì **: ì‹¤ì‹œê°„ ê²Œì„ ì„œë²„ì™€ ì´ë²¤íŠ¸ ê¸°ë°˜ í”Œë«í¼ ì„œë²„ê°€ ì‹¤ì œë¡œ ë¶„ë¦¬ë˜ì–´ ë™ì‘í•¨ì„ ì¦ëª…

**ì˜ˆìƒ ì†Œìš”**: 1~2ì£¼

-----

### 1-1. ê²Œì„ ì„œë²„ (C# TCP/IP)

#### êµ¬í˜„ ë²”ìœ„ (ìµœì†Œ)

```
âœ“ TCP/IP ì†Œì¼“ ì„œë²„
âœ“ Session ê´€ë¦¬
âœ“ Packet â†’ Command ë³€í™˜
âœ“ ë‹¨ì¼ GameLoop Tick
âœ“ In-memory Player State
âœ“ Domain Event ìƒì„±
âœ“ Kafka Producer ì—°ë™
```

#### ë°˜ë“œì‹œ í¬í•¨í•  ìµœì†Œ ê¸°ëŠ¥

**1. í”Œë ˆì´ì–´ ì ‘ì†**

```csharp
public void OnPlayerConnect(Session session)
{
    var player = new Player(session.PlayerId);
    _activePlayers.Add(player);
    
    PublishEvent(new PlayerConnectedEvent
    {
        PlayerId = player.Id,
        ConnectedAt = DateTime.UtcNow
    });
}
```

**2. ê°„ë‹¨í•œ ìƒíƒœ ë³€ê²½ (ìœ„ì¹˜ ë³€ê²½)**

```csharp
public void ProcessMoveCommand(MoveCommand cmd)
{
    var player = GetPlayer(cmd.PlayerId);
    
    // Validation
    if (!ValidateMove(cmd))
    {
        SendRejection(cmd.PlayerId, "Invalid move");
        return;
    }
    
    // State Change (ë©”ëª¨ë¦¬ì—ì„œ ì¦‰ì‹œ)
    var oldPosition = player.Position;
    player.Position = cmd.NewPosition;
    
    // Domain Event ë°œí–‰ (ë¹„ë™ê¸°)
    PublishEvent(new PlayerMovedEvent
    {
        PlayerId = player.Id,
        FromPosition = oldPosition,
        ToPosition = cmd.NewPosition,
        OccurredAt = DateTime.UtcNow
    });
    
    // ì¦‰ì‹œ ì‘ë‹µ (Kafka ì‘ë‹µ ëŒ€ê¸° X)
    SendResponse(cmd.PlayerId, player.Position);
}
```

#### ì˜ë„ì ìœ¼ë¡œ êµ¬í˜„í•˜ì§€ ì•ŠëŠ” ê²ƒ

```
âœ— ì „íˆ¬ ì‹œìŠ¤í…œ
âœ— MMO ì½˜í…ì¸ 
âœ— ë³µì¡í•œ ë™ê¸°í™” ë¡œì§
âœ— í´ë¼ì´ì–¸íŠ¸ ì˜ˆì¸¡
âœ— ì¸ë²¤í† ë¦¬ ì‹œìŠ¤í…œ
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
ê²Œì„ ì„œë²„:
â˜ TCP ì„œë²„ ê¸°ë™
â˜ í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ìˆ˜ë½
â˜ íŒ¨í‚· ìˆ˜ì‹  ë° ì—­ì§ë ¬í™”
â˜ Command ìƒì„±
â˜ GameLoop Tick ë™ì‘
â˜ Domain Event ë°œí–‰
â˜ Kafka ì—°ë™
â˜ ë¡œê·¸ ì¶œë ¥
```

-----

### 1-2. í”Œë«í¼ ì„œë²„ (TypeScript / bun.js)

#### êµ¬í˜„ ë²”ìœ„

```typescript
// Kafka Consumer
class EventConsumer {
  async start() {
    await this.kafka.subscribe('game.events.player');
    
    await this.kafka.consume(async (event) => {
      switch (event.type) {
        case 'PlayerConnectedEvent':
          await this.handlePlayerConnected(event);
          break;
        case 'PlayerMovedEvent':
          await this.handlePlayerMoved(event);
          break;
      }
    });
  }
  
  private async handlePlayerMoved(event: PlayerMovedEvent) {
    // ë‹¨ìˆœí•œ DB ì €ì¥ (MySQL)
    await this.db.insert('player_movements', {
      player_id: event.playerId,
      from_position: event.fromPosition,
      to_position: event.toPosition,
      occurred_at: event.occurredAt
    });
    
    console.log(`[Event] Player moved: ${event.playerId}`);
  }
}
```

#### í•µì‹¬ í¬ì¸íŠ¸

```
âœ“ í”Œë«í¼ ì„œë²„ëŠ” ì˜¤ì§ Kafka ì´ë²¤íŠ¸ë§Œ ì†Œë¹„
âœ“ ì‹¤ì‹œê°„ ë¡œì§ì— ì ˆëŒ€ ê°œì…í•˜ì§€ ì•ŠìŒ
âœ“ ê²Œì„ ì„œë²„ì™€ ì§ì ‘ í†µì‹ í•˜ì§€ ì•ŠìŒ
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
í”Œë«í¼ ì„œë²„:
â˜ Kafka Consumer ì—°ê²°
â˜ ì´ë²¤íŠ¸ ìˆ˜ì‹  í™•ì¸
â˜ ì´ë²¤íŠ¸ íŒŒì‹±
â˜ DB ì €ì¥
â˜ ë¡œê·¸ ì¶œë ¥
â˜ ê°„ë‹¨í•œ API ì—”ë“œí¬ì¸íŠ¸ (ì„ íƒ)
```

-----

### 1-3. Unity í´ë¼ì´ì–¸íŠ¸ (ì¦ëª…ìš© í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸)

#### êµ¬í˜„ ë²”ìœ„

```csharp
public class PlayerController : MonoBehaviour
{
    private NetworkClient _client;
    
    void Update()
    {
        // ì…ë ¥ ê°ì§€
        if (Input.GetKeyDown(KeyCode.W))
        {
            var newPos = transform.position + Vector3.forward;
            
            // ë¡œì»¬ì—ì„œ ì¦‰ì‹œ ë³€ê²½í•˜ì§€ ì•ŠìŒ!
            // ì„œë²„ì— ìš”ì²­ë§Œ ì „ì†¡
            _client.SendMoveRequest(newPos);
            
            Debug.Log($"[Client] Move requested: {newPos}");
        }
    }
    
    // ì„œë²„ë¡œë¶€í„° ìŠ¹ì¸ëœ ìœ„ì¹˜ë§Œ ë°˜ì˜
    public void OnServerMoveConfirmed(Vector3 serverPosition)
    {
        transform.position = serverPosition;
        Debug.Log($"[Client] Move confirmed: {serverPosition}");
    }
}
```

#### ì‹œê°ì  ê¸°ì¤€

```
âœ“ íë¸Œ í•˜ë‚˜ë©´ ì¶©ë¶„
âœ“ ëšëš ì´ë™í•´ë„ ë¬¸ì œ ì—†ìŒ
âœ“ ë¶€ë“œëŸ¬ìš´ ë³´ê°„(Lerp)ì€ ì„ íƒ ì‚¬í•­
âœ“ Debug UIë¡œ ìƒíƒœ í‘œì‹œ
```

#### ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Unity í´ë¼ì´ì–¸íŠ¸:
â˜ TCP ì—°ê²°
â˜ íŒ¨í‚· ì „ì†¡
â˜ íŒ¨í‚· ìˆ˜ì‹ 
â˜ WASD ì…ë ¥
â˜ ì„œë²„ ì‘ë‹µ ëŒ€ê¸°
â˜ ìœ„ì¹˜ ê°±ì‹ 
â˜ Debug ë¡œê·¸ ì¶œë ¥
```

-----

### MVP ë‹¨ê³„ì—ì„œ ì¦ëª…ë˜ëŠ” ê²ƒ

```
âœ“ ì‹¤ì‹œê°„ íŒì •ê³¼ ê¸°ë¡ì˜ ë¶„ë¦¬ êµ¬ì¡°
âœ“ ì„œë¡œ ë‹¤ë¥¸ ì–¸ì–´(C#, TypeScript) ê°„ ì´ë²¤íŠ¸ ì—°ê³„
âœ“ ê²Œì„ ì„œë²„ëŠ” ê°€ë³ê³ , í”Œë«í¼ ì„œë²„ê°€ ë¬´ê±°ìš´ ì±…ì„
âœ“ Server-authoritative êµ¬ì¡°
```

**ì´ ë‹¨ê³„ê¹Œì§€ê°€ MVPì´ë©°, ì—¬ê¸°ê¹Œì§€ë§Œìœ¼ë¡œë„ í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ì¶©ë¶„í•œ ì„¤ë“ë ¥ì„ ê°€ì§‘ë‹ˆë‹¤.**

-----

### Phase 1 ì™„ë£Œ ì¡°ê±´

```
â˜ ê²Œì„ ì„œë²„ ì‹¤í–‰
â˜ Unity í´ë¼ì´ì–¸íŠ¸ ì—°ê²°
â˜ WASDë¡œ ì´ë™ ìš”ì²­
â˜ ì„œë²„ì—ì„œ ê²€ì¦ í›„ ìŠ¹ì¸
â˜ Kafkaë¡œ ì´ë²¤íŠ¸ ë°œí–‰
â˜ í”Œë«í¼ ì„œë²„ì—ì„œ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
â˜ DBì— ì´ë™ ê¸°ë¡ ì €ì¥
â˜ 1ë¶„ ì˜ìƒ ë…¹í™”
```

-----

## Phase 2: ì´ë²¤íŠ¸ ì‹ ë¢°ì„±

### ğŸ“‹ ê³„íš

**ëª©ì **: Kafka ê¸°ë°˜ êµ¬ì¡°ì—ì„œ ë°˜ë“œì‹œ ì§ˆë¬¸ë°›ê²Œ ë˜ëŠ” â€œì´ë²¤íŠ¸ ì‹ ë¢°ì„±â€ì— ëŒ€í•œ ë‹µì„ ì œì‹œ

**ì˜ˆìƒ ì†Œìš”**: 3~5ì¼

-----

### 2-1. Domain Event í™•ì¥

#### ì´ë²¤íŠ¸ ë©”íƒ€ë°ì´í„° ì¶”ê°€

```csharp
public abstract class DomainEvent
{
    public string EventId { get; set; }        // UUID
    public string AggregateId { get; set; }    // playerId ë˜ëŠ” entityId
    public DateTime OccurredAt { get; set; }   // ë°œìƒ ì‹œê°
    public int Version { get; set; }           // ì´ë²¤íŠ¸ ë²„ì „
}

public class PlayerMovedEvent : DomainEvent
{
    public string PlayerId { get; set; }
    public Vector3 FromPosition { get; set; }
    public Vector3 ToPosition { get; set; }
}
```

-----

### 2-2. í”Œë«í¼ ì„œë²„ ì²˜ë¦¬ ì „ëµ

#### Idempotency êµ¬í˜„

```typescript
class IdempotentEventHandler {
  async handle(event: DomainEvent) {
    const key = `event:${event.eventId}`;
    
    // ì´ë¯¸ ì²˜ë¦¬ëœ ì´ë²¤íŠ¸ì¸ì§€ í™•ì¸
    const processed = await this.redis.get(key);
    if (processed) {
      logger.info(`Event already processed: ${event.eventId}`);
      return;
    }
    
    try {
      // ì´ë²¤íŠ¸ ì²˜ë¦¬
      await this.processEvent(event);
      
      // ì²˜ë¦¬ ì™„ë£Œ ê¸°ë¡ (TTL: 1ì‹œê°„)
      await this.redis.setex(key, 3600, 'processed');
    } catch (error) {
      // ì‹¤íŒ¨ ì‹œ DLQë¡œ ì „ì†¡
      await this.sendToDLQ(event, error);
    }
  }
}
```

-----

### 2-3. DLQ (Dead Letter Queue)

```
ì •ìƒ íë¦„:
[ Game Server ] â†’ [ Kafka ] â†’ [ Platform Server ] â†’ [ DB ]

ì‹¤íŒ¨ íë¦„:
[ Game Server ] â†’ [ Kafka ] â†’ [ Platform Server ]
                                     â†“ (ì‹¤íŒ¨)
                                [ DLQ Topic ]
                                     â†“ (ìˆ˜ë™ ì²˜ë¦¬)
                                [ Admin Review ]
```

#### í•µì‹¬ ì›ì¹™

```
âœ“ DB ì €ì¥ ì‹¤íŒ¨ ì‹œ ì¦‰ì‹œ ì¬ì‹œë„í•˜ì§€ ì•ŠìŒ
âœ“ ê²Œì„ ì„œë²„ëŠ” ì‹¤íŒ¨ ì—¬ë¶€ë¥¼ ì•Œì§€ ëª»í•¨
âœ“ ì‹¤íŒ¨ ì²˜ë¦¬ëŠ” ì „ì ìœ¼ë¡œ ìš´ì˜ ì˜ì—­ì˜ ì±…ì„
```

-----

### Phase 2 ì™„ë£Œ ì¡°ê±´

```
â˜ Event ID ì¶”ê°€
â˜ Idempotency ê²€ì¦ ë¡œì§
â˜ Redis ì¤‘ë³µ ì²´í¬
â˜ DLQ Topic ìƒì„±
â˜ ì‹¤íŒ¨ ì´ë²¤íŠ¸ DLQ ì „ì†¡
â˜ í…ŒìŠ¤íŠ¸: ë™ì¼ ì´ë²¤íŠ¸ 2ë²ˆ ì „ì†¡ ì‹œ 1ë²ˆë§Œ ì²˜ë¦¬
```

-----

## Phase 3: Snapshot

### ğŸ“‹ ê³„íš

**ëª©ì **: ê²Œì„ ì„œë²„ ì¥ì•  ì‹œì—ë„ ì„œë¹„ìŠ¤ê°€ ë³µêµ¬ ê°€ëŠ¥í•¨ì„ êµ¬ì¡°ì ìœ¼ë¡œ ì¦ëª…

**ì˜ˆìƒ ì†Œìš”**: 4~7ì¼

-----

### 3-1. Hot Snapshot (Redis)

```csharp
public class RedisSnapshotService
{
    private readonly IRedisClient _redis;
    
    // ì£¼ê¸°ì ìœ¼ë¡œ Player State ì €ì¥ (5~10ì´ˆ)
    public async Task SaveHotSnapshot(Player player)
    {
        var key = $"snapshot:player:{player.Id}";
        
        // MessagePackìœ¼ë¡œ binary ì§ë ¬í™”
        var snapshot = MessagePackSerializer.Serialize(player);
        
        // TTL: 5ë¶„
        await _redis.SetAsync(key, snapshot, TimeSpan.FromMinutes(5));
    }
    
    // ë³µêµ¬
    public async Task<Player> LoadHotSnapshot(string playerId)
    {
        var key = $"snapshot:player:{playerId}";
        var snapshot = await _redis.GetAsync<byte[]>(key);
        
        if (snapshot == null)
            return null;
        
        return MessagePackSerializer.Deserialize<Player>(snapshot);
    }
}
```

**íŠ¹ì§•**:

```
âœ“ ì •í™•ì„±ë³´ë‹¤ ì†ë„ë¥¼ ìš°ì„ 
âœ“ TTLë¡œ ìë™ ì •ë¦¬
âœ“ ìˆ˜ì´ˆ ë‚´ ë³µêµ¬ ê°€ëŠ¥
```

-----

### 3-2. Cold Snapshot (MongoDB)

```csharp
public class MongoSnapshotService
{
    // ì„œë²„ ì¢…ë£Œ ë˜ëŠ” ì¥ì•  ì‹œ
    public async Task SaveColdSnapshot(Zone zone)
    {
        var snapshot = new ZoneSnapshot
        {
            ZoneId = zone.Id,
            Timestamp = DateTime.UtcNow,
            Players = zone.Players.Select(p => p.Serialize()).ToList(),
            Checksum = CalculateChecksum(zone)
        };
        
        await _mongo.InsertOneAsync(snapshot);
    }
    
    // ë³µêµ¬
    public async Task<ZoneSnapshot> LoadColdSnapshot(string zoneId)
    {
        var snapshot = await _mongo
            .Find(s => s.ZoneId == zoneId)
            .SortByDescending(s => s.Timestamp)
            .FirstOrDefaultAsync();
        
        return snapshot?.Deserialize();
    }
}
```

**íŠ¹ì§•**:

```
âœ“ ì¥ê¸° ë³´ê´€
âœ“ ì •í•©ì„± ê²€ì¦ (Checksum)
âœ“ ì ê²€ ë° ë¶„ì„ ìš©ë„
```

-----

### 3-3. ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤

```
[ ê²Œì„ ì„œë²„ í¬ë˜ì‹œ ]
    â†“
[ ë³µêµ¬ í”„ë¡œì„¸ìŠ¤ ì‹œì‘ ]
    â†“
1. Redis Snapshot ì¡´ì¬?
   Yes â†’ ì¦‰ì‹œ ë³µêµ¬ (ìˆ˜ì´ˆ)
   No â†’ 2ë‹¨ê³„
    â†“
2. MongoDB Snapshot ì¡´ì¬?
   Yes â†’ ë³µêµ¬ (ìˆ˜ë¶„)
   No â†’ 3ë‹¨ê³„
    â†“
3. ì´ˆê¸° ìƒíƒœë¡œ ì‹œì‘
   (Kafka Event Replayë¡œ ë³´ì • ê°€ëŠ¥)
```

-----

### Phase 3 ì™„ë£Œ ì¡°ê±´

```
â˜ Redis Snapshot ì €ì¥
â˜ Redis Snapshot ë¡œë“œ
â˜ MongoDB Snapshot ì €ì¥
â˜ MongoDB Snapshot ë¡œë“œ
â˜ ë³µêµ¬ ìš°ì„ ìˆœìœ„ ë¡œì§
â˜ í…ŒìŠ¤íŠ¸: ê²Œì„ ì„œë²„ ì¬ì‹œì‘ í›„ í”Œë ˆì´ì–´ ìƒíƒœ ë³µì›
```

-----

## Phase 4: Admin Dashboard

### ğŸ“‹ ê³„íš

**ëª©ì **: ìš´ì˜ ë„êµ¬ë¥¼ ì‹¤ì œë¡œ êµ¬í˜„í•˜ì—¬ ì‹œìŠ¤í…œì˜ ìš´ì˜ ê°€ëŠ¥ì„±ì„ ì¦ëª…

**ì˜ˆìƒ ì†Œìš”**: 3~5ì¼

-----

### 4-1. React ê¸°ë°˜ ìš´ì˜ ë„êµ¬ êµ¬í˜„

**ê´€ë ¨ í”„ë¡œì íŠ¸**: [React Object State Manager](https://github.com/1985jwlee/portpolio_react)

Phase 4ì—ì„œëŠ” ì„¤ê³„ëœ Admin Dashboardë¥¼ ì‹¤ì œë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.

#### êµ¬í˜„ ì˜ˆì • ê¸°ëŠ¥

```
1. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
   - Zoneë³„ ë™ì ‘ì ìˆ˜ (CCU)
   - GameLoop Tick ì§€ì—° ëª¨ë‹ˆí„°ë§
   - ì„œë²„ Health Check í˜„í™©

2. í”Œë ˆì´ì–´ ìƒíƒœ ì¡°íšŒ
   - í”Œë ˆì´ì–´ë³„ ì˜¤ë¸Œì íŠ¸ ìƒíƒœ
   - Component í•„ë“œê°’ ì‹¤ì‹œê°„ ì¡°íšŒ
   - ìƒíƒœ ë³€ê²½ ì´ë ¥

3. Event Stream ì‹œê°í™”
   - Kafka Topicë³„ ì´ë²¤íŠ¸ íë¦„
   - Consumer Lag ëª¨ë‹ˆí„°ë§
   - ì´ë²¤íŠ¸ ì²˜ë¦¬ ì†ë„

4. ì¥ì•  ëŒ€ì‘ ì¸í„°í˜ì´ìŠ¤
   - Snapshot ë³µêµ¬ íŠ¸ë¦¬ê±°
   - ì„œë²„ ì¬ì‹œì‘ ì»¨íŠ¸ë¡¤
   - ê¸´ê¸‰ ê³µì§€ ë°œì†¡

5. Snapshot ê´€ë¦¬
   - Hot/Cold Snapshot ì¡°íšŒ
   - ìˆ˜ë™ Snapshot ìƒì„±
   - ë³µêµ¬ í…ŒìŠ¤íŠ¸
```

#### ê¸°ìˆ  ìŠ¤íƒ

```
Frontend: React 19 + TypeScript
State: Zustand (ì „ì—­ ìƒíƒœ ê´€ë¦¬)
UI: Tailwind CSS
Real-time: WebSocket (Server â†’ Client)
API: REST (Client â†’ Server)
```

#### React í”„ë¡œí† íƒ€ì…ì—ì„œ ê²€ì¦ëœ ê²ƒ

- âœ… ë™ì  ì˜¤ë¸Œì íŠ¸ ìƒíƒœ ê´€ë¦¬
- âœ… Component ê¸°ë°˜ í•„ë“œ í¸ì§‘
- âœ… ìƒíƒœ ì €ì¥/ë³µì› ë©”ì»¤ë‹ˆì¦˜
- âœ… Snapshot ê´€ë¦¬ UI

ì´ í”„ë¡œí† íƒ€ì…ì„ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ Admin Dashboardë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

-----

### 4-2. í”Œë«í¼ ì„œë²„ WebSocket API

```typescript
import { Elysia } from 'elysia';
import { ws } from '@elysiajs/websocket';

const app = new Elysia()
  .use(ws())
  .ws('/ws/monitor', {
    open(ws) {
      // ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ìŠ¤íŠ¸ë¦¼ ì‹œì‘
      const interval = setInterval(() => {
        ws.send({
          type: 'metrics',
          data: {
            ccu: getCurrentCCU(),
            tickDelay: getAverageTickDelay(),
            eventRate: getEventRate()
          }
        });
      }, 1000);
      
      ws.data.interval = interval;
    },
    close(ws) {
      clearInterval(ws.data.interval);
    }
  });
```

-----

### 4-3. Dashboard í•µì‹¬ ì»´í¬ë„ŒíŠ¸

```tsx
// ì‹¤ì‹œê°„ ì„œë²„ ìƒíƒœ ëª¨ë‹ˆí„°
function ServerMonitor() {
  const [metrics, setMetrics] = useState<Metrics>();
  
  useEffect(() => {
    const ws = new WebSocket('ws://localhost:3000/ws/monitor');
    
    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if (data.type === 'metrics') {
        setMetrics(data.data);
      }
    };
    
    return () => ws.close();
  }, []);
  
  return (
    <div className="grid grid-cols-3 gap-4">
      <MetricCard
        title="CCU"
        value={metrics?.ccu || 0}
        status={metrics?.ccu > 1000 ? 'warning' : 'normal'}
      />
      <MetricCard
        title="Tick Delay"
        value={`${metrics?.tickDelay || 0}ms`}
        status={metrics?.tickDelay > 70 ? 'warning' : 'normal'}
      />
      <MetricCard
        title="Event Rate"
        value={`${metrics?.eventRate || 0}/s`}
      />
    </div>
  );
}
```

-----

### Phase 4 ì™„ë£Œ ì¡°ê±´

```
â˜ WebSocket API êµ¬í˜„
â˜ React Dashboard êµ¬í˜„
â˜ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ê¸°ëŠ¥
â˜ í”Œë ˆì´ì–´ ìƒíƒœ ì¡°íšŒ
â˜ Snapshot ê´€ë¦¬ UI
â˜ ë°ëª¨ ì˜ìƒ ë…¹í™”
â˜ ì‹¤í–‰ ê°€ì´ë“œ ì‘ì„±
```

-----

## ê°€ì¥ ì¤‘ìš”í•œ ê²°ë¡ 

> **ì´ ë¡œë“œë§µì˜ ëª©ì ì€ â€œì™„ì„±â€ì´ ì•„ë‹™ë‹ˆë‹¤.**

> **â€œì´ ì‚¬ëŒì€ ì–¸ì œ êµ¬í˜„ì„ ë©ˆì¶°ì•¼ í•˜ëŠ”ì§€ë„ ì•„ëŠ” ì—”ì§€ë‹ˆì–´ë‹¤â€**

> **ì´ ì¸ìƒì„ ë‚¨ê¸°ëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤.**

-----

[â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°](../README.md)